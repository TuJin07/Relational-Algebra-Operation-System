#### 关系增删 @tujin

~~新增关系时输入项留空时点击确认新增~~

- ~~预期结果：弹窗提示用户XX不能为空，不添加表。~~
- ~~实际结果：符合预期。~~

~~新增关系时输入的行列数与内容文本本身不符合~~

- ~~预期结果：弹窗提示用户内容与行列数不匹配，不添加表。~~
- ~~实际结果：符合预期。~~

新增关系时输入了非法字符（如行列数里输入英文字符/负数，使用了中文逗号分隔等）@tujin

- 预期结果：根据特定的输入，提示用户输入了非法字符，不添加表。
  - 定义列名与表名的非法字符：“,”，“$”,”|”,”*”,”#”,”(”,”)”。
  - 定义列名与表名的合法字符：英文字符大小写，阿拉伯数字，中文字符。

- 实际结果：
  - 行长和列长输入了英文字符：后端转化Json时直接报错，中止新增，前端提示“输入关系表失败”。
  - 行长和列长输入了负数：触发其他错误，如行长列长不匹配内容等。
  - 列名与内容中使用了中文逗号分隔：中文逗号将不被识别为分隔符，会被识别为列名的一部分，如果列名数/内容数满足要求，表可以正常被添加，否则会报列名/内容数量错误。
  - 表名中输入了“#”或是“,”,“(”等特殊字符：正常添加。
  - 列名中输入了“$”或是“|”“(”等特殊字符：正常添加。


~~添加列名时列名重复 @tujin~~

- ~~预期结果：前端提示列名不能重复，不添加关系。~~
- ~~实际结果：正常添加。~~

~~未新增关系时删除关系~~

- ~~预期结果：正常删除。~~
- ~~实际结果：符合预期。~~

新增关系后修改内容框再点击删除关系 @serum

- 预期结果：不能让用户新增关系后再修改关系内容。
- 实际结果：用户可以修改关系内容。

~~重复提交重名关系 @tujin~~

- ~~预期结果：前端提示名为A的关系已存在，不添加表。~~
- ~~实际结果：会覆盖之前添加的表。~~

#### 关系运算

##### 输入框 @tujin

输入的表达式格式不合法（包含非法字符/多余的空格/括号不匹配等）

- 预期结果：提前检查，不合法的表达式在前端提示用户表达式不合法。
- 实际结果：计算过程中抛异常，后端报错，前端没有任何反应，像卡住一样。

输入的表达式中含未添加的关系名

- 预期结果：提示用户含未添加的关系名。
- 实际结果：
  - 情况一：表达式只包含单个未添加的关系名，如“Course”，提交时前端会提示“提交错误”。
  - 情况二：在不只是单个关系名的表达式中包含未添加的关系名，提交时后端报错，前端同输入格式不合法，无响应。


##### 交 @manqi

~~两个结构不同的表进行运算结果 @tujin~~

- ~~预期结果：抛出异常终止运算~~
- ~~实际结果：返回了空行空列的空表~~

~~两个结构相同的表但列名顺序不同的运算结果~~

- ~~预期结果：列名顺序不影响运算，返回交运算的正确结果~~
- ~~实际结果：列名顺序不影响运算，返回交运算的正确结果~~

~~结果为空时的返回结果问题~~

- ~~预期结果：返回有列空表~~
- ~~实际结果：返回有列空表~~

~~两个表之间包含空表（分为是否有列）的情况 @tujin~~

- ~~预期结果~~
  - ~~有列：返回有列空表~~
  - ~~无列：相当于结构不同，抛出异常终止运算~~

- ~~实际结果~~
  - ~~有列：返回有列空表，且报告“返回空表”~~
  - ~~无列：相当于结构不同，返回了空行空列的空表~~


##### 并 @manqi

~~两个结构不同的表进行运算的结果 @tujin~~

- ~~预期结果：抛出异常终止运算~~
- ~~实际结果：返回空行空列的空表~~

~~两个结构相同的表但列名顺序不同的运算结果~~

- ~~预期结果：列名顺序不影响运算，返回并运算的正确结果~~
- ~~实际结果：列名顺序不影响运算，返回并运算的正确结果~~

~~结果为空时的返回结果问题~~ 

- ~~预期结果：返回保留列名空表~~
- ~~实际结果：不知道怎么测试~~

~~两个表之间包含空表（分为是否有列）的情况 @tujin~~

- ~~预期结果~~
  - ~~有列：返回两表中的非空表~~
  - ~~无列：相当于结构不同，抛出异常终止运算~~

- ~~实际结果~~
  - ~~有列：返回两表中的非空表~~
  - ~~无列：相当于结构不同，返回空行空列的空表~~


##### 差 @manqi

两个结构不同的表进行运算的结果 @tujin @serum 不修复错误文本写死bug无法继续

- 预期结果：抛出异常终止运算
- 实际结果：返回空行空列的空表

~~两个结构相同的表但列名顺序不同的运算结果~~

- ~~预期结果：列名顺序不影响运算，返回差运算的正确结果~~
- ~~实际结果：列名顺序不影响运算，返回差运算的正确结果~~

~~结果为空时的返回结果问题~~

- ~~预期结果：返回有列空表~~
- ~~实际结果：返回有列空表，且报告“返回空表”~~

两个表之间包含空表（分为是否有列）的情况 @tujin @serum 不修复括号bug无法继续

- 预期结果
  - 有列：如果是前者为空，则返回有列空表；如果是后者为空，则返回前表
  - 无列：相当于结构不同，抛出异常终止运算

- 实际结果
  - 有列：前者为空，返回有列空表；后者为空不知道怎么测试
  - 无列：相当于结构不同，返回空行空列的空表


##### 笛卡尔积 @manqi

~~两个表之间包含同名列时进行笛卡尔积 @manqi~~

- ~~预期结果：得出结果后的同名列应按A.列和B.列分别命名~~
- ~~实际结果：得出结果后同名列没有进行区分~~

两个表之间包含空表（分为是否有列）的情况 @serum

- 预期结果
  - 有列：保留两表列名的空表
  - 无列：保留两表中非空表列名的空表

- 实际结果
  - 有列：
    - 前端：结果表不变（有上次的结果时保留上次的结果
    - 后端：保留两表列名的空表

  - 无列
    - 前端：保留两表中非空表列名的空表，且显示“返回空表：
    - 后端：保留两表中非空表列名的空表

##### 选择 @manqi

~~输入的条件式为空 @tujin @serum~~

- ~~预期结果：返回输入表~~
- ~~实际结果：结果表不变（有上次的结果时保留上次的结果~~

~~条件的列名不合法（不包含的列名/列名为空等）@tujin~~

- ~~预期结果：抛出异常~~
- ~~实际结果：离谱的错误答案~~
- ![image-20230108144003869](assets\image-20230108144003869.png)
- ![image-20230108144027482](assets\image-20230108144027482.png)

输入的表达式格式不合法（包含非法字符/多余的空格/括号不匹配/不包含运算符等）@tujin

- 预期结果：抛出异常
- 实际结果
  - 前端
    - 结果表不变

  - 后端

    - 包含非法字符
      - 输入：* 报错（java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 1

    - 多余空格
      - 在最前面：答案正确
      - 在中间：答案错误
      - 在最后面：答案错误

    - 括号不匹配
      - 输入：(C=c)) 答案正确
      - 输入：(() 报错（java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 1

    - 不包含运算符
      - 输入：Cc 报错（java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 1


空表的处理 @tujin @serum

- 预期结果
  - 有列：返回有列空表
  - 无列：返回无列空表

- 实际结果
  - 有列
    - 前端：结果表不变
    - 后端：返回有列空表

  - 无列
    - 前端：结果表不变
    - 后端：返回无列空表

##### 投影 @manqi

额外测出的错误（后端单独测是对的 @manqi @serum 讨论下这个错误是怎么出现的

<img src="assets\image-20230108144707157.png" alt="image-20230108144707157" style="zoom:67%;" />

~~条件的列名不合法（不包含的列名/列名为空等）@manqi~~

- ~~预期结果：抛出异常~~
- ~~实际结果~~
  - ~~前端~~
    - ~~有的不包含的列名也有结果，比如~~
    - ~~![image-20230108145224550](assets\image-20230108145224550.png)~~

  - ~~后端~~
    - ~~不包含列名：报错（java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 0~~
    - ~~列明为空：抛出ParamLenException e异常~~


~~输入的表达式格式不合法（不遵循列名的格式输入等）@tujin~~

- ~~预期结果：抛出异常~~
- ~~实际结果：结果表不变~~

条件列名为空

空表（分为有列的空表和无列的空表）的处理 @tujin

- 预期结果
  - 有列：返回有列空表
  - 无列：抛出异常

- 实际结果：
  - 有列
    - 前端：结果表不变
    - 后端：返回有列空表

  - 无列
    - 前端：结果表不变
    - 后端：java.lang.ArrayIndexOutOfBoundsException


##### 连接 @manqi

~~两个表没有相同的列~~

- ~~预期结果：相当于笛卡尔积~~
- ~~实际结果：相当于笛卡尔积~~

~~A.name与B.name与name的连接 @manqi~~

- ~~预期结果：相当于笛卡尔积~~
- ~~实际结果：还没写A.name~~

##### 除 @manqi

除数为空表时 @manqi

- 预期结果
  - ~~有列空表：列名去相同列的有列空表~~
  - ~~无列空表：有列空表~~

- 实际结果（后端测的，前端不会输入
  - ~~有列空表：列名去相同列的有列空表~~
  - ~~无列空表：无列空表~~


被除数为空表时 @manqi

- 预期结果
  - ~~有列空表：列名去相同列的有列空表~~
  - 无列空表：返回无列空表
- 实际结果
  - 有列空表：
    - ~~后端：列名去相同列的有列空表~~
    - 前端：显示提交错误
  - 无列空表：返回无列空表，且显示返回空表



#### 结果显示 @serum

结果列很长时/行很长时

- 预期结果：
- 实际结果：

重复提交预设关系报错

括号卡死

前端错误信息写死

嵌套表达式空格